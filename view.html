<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com; style-src 'self' 'unsafe-inline' https://unpkg.com; img-src 'self' data: https:; connect-src 'self' https://*.supabase.co https://api.openweathermap.org; font-src 'self' data:; frame-src 'none'; object-src 'none';">
    <title>DateScape - Date Review</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
    <div class="container">
        <div id="auth-widget"></div>

        <div class="back-bar">
            <a href="index.html" class="back-link">Back to Home</a>
        </div>

        <header>
            <h1 id="page-title">Loading...</h1>
            <p class="subtitle" id="page-subtitle"></p>
            <p class="subtitle" id="page-dates"></p>
        </header>

        <div id="weather-widget" class="weather-widget"></div>

        <div class="review-workspace">
            <div class="mobile-workspace-tabs" role="tablist" aria-label="Review page section tabs">
                <button type="button" id="mobile-tab-map" role="tab" class="mobile-workspace-tab is-active" aria-selected="true" aria-controls="mobile-panel-map" data-mobile-view="map">Map</button>
                <button type="button" id="mobile-tab-places" role="tab" class="mobile-workspace-tab" aria-selected="false" aria-controls="mobile-panel-places" data-mobile-view="places">Places</button>
            </div>

            <div class="map-section" id="mobile-panel-map" role="tabpanel" aria-labelledby="mobile-tab-map" data-mobile-section="map">
                <div class="map-container">
                    <div id="map"></div>
                </div>
            </div>

            <aside class="overview-panel" id="mobile-panel-overview" aria-label="Trip overview" data-mobile-section="overview">
                <div class="section-heading overview-title" id="overview-title-heading">Trip Overview</div>
                <div id="overview-stats" class="overview-stats">
                    <div class="overview-card">
                        <p class="overview-label">Total Places</p>
                        <p class="overview-value" id="overview-total-places">0</p>
                    </div>
                    <div class="overview-card">
                        <p class="overview-label">Total Reviews</p>
                        <p class="overview-value" id="overview-total-reviews">0</p>
                    </div>
                    <div class="overview-card">
                        <p class="overview-label">Restaurants</p>
                        <p class="overview-value" id="overview-restaurant-count">0</p>
                    </div>
                    <div class="overview-card">
                        <p class="overview-label">Cafes</p>
                        <p class="overview-value" id="overview-cafe-count">0</p>
                    </div>
                    <div class="overview-card">
                        <p class="overview-label">Reviewed Places</p>
                        <p class="overview-value" id="overview-reviewed-places">0</p>
                    </div>
                    <div class="overview-card">
                        <p class="overview-label">Unreviewed Places</p>
                        <p class="overview-value" id="overview-unreviewed-places">0</p>
                    </div>
                    <div class="overview-card">
                        <p class="overview-label">Avg. Rating</p>
                        <p class="overview-value" id="overview-avg-rating">0.0</p>
                    </div>
                    <div class="overview-card">
                        <p class="overview-label">Latest Review</p>
                        <p class="overview-value" id="overview-latest-review">-</p>
                    </div>
                    <div class="overview-card">
                        <p class="overview-label">Avg Reviews / Place</p>
                        <p class="overview-value" id="overview-avg-reviews-per-place">0.0</p>
                    </div>
                </div>

                <div class="overview-filter">
                    <p class="overview-filter-title">Filter by type</p>
                    <div class="overview-filter-actions" role="group" aria-label="Place type filter">
                        <button class="overview-filter-btn is-active" type="button" data-filter="all">All</button>
                        <button class="overview-filter-btn" type="button" data-filter="restaurant">Restaurant</button>
                        <button class="overview-filter-btn" type="button" data-filter="cafe">Cafe</button>
                    </div>
                </div>

                <div class="overview-help">
                    <p class="overview-help-title">Tip</p>
                    <p>Tap a card to write a review after login. Scroll list if content is long.</p>
                </div>
            </aside>

            <div class="places-section" id="mobile-panel-places" role="tabpanel" aria-labelledby="mobile-tab-places" data-mobile-section="places">
                <div class="places-header">
                    <h2 class="section-heading">Places We Visited</h2>
                    <button id="add-place-btn" class="add-place-btn" style="display:none;" onclick="showAddPlaceModal()">+ Add Place</button>
                </div>
                <div class="mobile-overview-strip" aria-label="Trip quick summary">
                    <div class="mobile-overview-strip-card">
                        <p class="mobile-overview-strip-label">Places</p>
                        <p class="mobile-overview-strip-value" id="mobile-overview-total-places">0</p>
                    </div>
                    <div class="mobile-overview-strip-card">
                        <p class="mobile-overview-strip-label">Reviews</p>
                        <p class="mobile-overview-strip-value" id="mobile-overview-total-reviews">0</p>
                    </div>
                    <div class="mobile-overview-strip-card">
                        <p class="mobile-overview-strip-label">Avg Rating</p>
                        <p class="mobile-overview-strip-value" id="mobile-overview-avg-rating">-</p>
                    </div>
                </div>
                <div class="mobile-place-filters">
                    <button class="overview-filter-btn is-active" type="button" data-filter="all">All</button>
                    <button class="overview-filter-btn" type="button" data-filter="restaurant">Restaurant</button>
                    <button class="overview-filter-btn" type="button" data-filter="cafe">Cafe</button>
                </div>
                <div id="places-list" class="places-list">
                    <div class="loading">Loading places...</div>
                </div>
            </div>
        </div>

        <footer>
            <p>Built for romantic getaways</p>
        </footer>
    </div>

    <script src="config.js"></script>
    <script src="components/auth.js"></script>
    <script src="components/reviews.js"></script>
    <script src="components/weather.js"></script>
    <script src="app.js"></script>
</body>

</html>
